import{d as k,az as x,aA as S,r as I,c as P,aC as q,o as m,a as f,j as h,u as g,b as t,n as _,au as B,t as c,ax as M,aD as U,q as w}from"./index.db4b08e0.js";import{m as b}from"./mutation.640962a3.js";import{q as D}from"./queryParser.785886e3.js";import{M as N}from"./MiniPin.42e30b56.js";const T={class:"chat-detail"},j={class:"is-flex is-justify-content-space-between"},z={class:"chat-username fs-13 fw-600"},V={class:"is-flex is-align-items-center",style:{"column-gap":"4px"}},A={key:0,class:"unread-count fn-secondary fs-9 fw-800"},H={class:"chat-chat fs-12 fn-secondary fw-400"},R=k({__name:"SectionChatSingle",props:{index:null,image:null,username:null,lastMessage:null,isOpposite:{type:Boolean},unreadCount:null,ispinned:{type:Boolean},messageId:null},setup(C){const e=C,l=x(),v=S(),n=I(e.ispinned),u=P(()=>{if(e.messageId){const{group:s,shop:a}=l.query;return s&&a?[l.path,D({group:s,shop:a,chat:e.messageId})].join("?"):l.fullPath}else return l.fullPath}),r=(s,a,i="pin")=>{const o=(y="pin")=>{y==="pin"?n.value=!0:n.value=!1};i==="unpin"?b("unpinUserChat","chat/unpin","PUT",null,{msg_id:a,shopid:s},{onSuccess:()=>o("unpin")}):b("pinUserChat","chat/pin","PUT",null,{msg_id:a,shopid:s},{onSuccess:()=>o()})},p=s=>{const{shop:a}=l.query,i=String(e.messageId);s?r(String(a),i):r(String(a),i,"unpin")},d=s=>{s.preventDefault(),U([{label:"Balas chat",onClick:()=>{v.push(u.value)},iconClass:"bi bi-reply fs-12 rotate-flip-180"},{label:n.value?"Hapus tanda":"Tandai chat",onClick:()=>{p(!n.value)},iconClass:n.value?"bi bi-pin-fill fs-11":"bi bi-pin fs-11"},{label:"Hapus chat",onClick:()=>{console.log("saya akan hapus "+e.index)},iconClass:"bi bi-trash fs-11",disable:!0},{disable:!0,label:"Tandai belum dibaca",onClick:()=>{console.log("saya akan belum baca "+e.index)},iconClass:"bi bi-envelope fs-11"},{disable:!0,label:"Arsipkan chat",onClick:()=>{console.log("saya akan belum baca "+e.index)},iconClass:"bi bi-archive fs-11"}],s.x,s.y)};return(s,a)=>{const i=q("router-link");return m(),f("div",{onContextmenu:d,onDblclick:d,class:_(Number(g(l).query.chat)===e.messageId?"tpd-chat-active":"tpd-chat")},[h(i,{class:"tpd-chat-link",to:g(u)},null,8,["to"]),t("div",{class:_(["chat-pin",n.value&&"chat-pin-pinned"])},[h(N,{pinned:n.value,"onUpdate:pinned":a[0]||(a[0]=o=>n.value=o),onClick:a[1]||(a[1]=o=>p(n.value))},null,8,["pinned"])],2),t("div",{style:B({backgroundImage:`url('${e.image}')`}),class:"chat-userimage"},null,4),t("div",T,[t("div",j,[t("h4",z,c(e.username),1)]),t("div",V,[e.unreadCount?(m(),f("span",A,c(e.unreadCount),1)):M("",!0),t("span",H,c(e.lastMessage),1)])])],34)}}});const G=w(R,[["__scopeId","data-v-e6a2c56f"]]);export{G as default};
