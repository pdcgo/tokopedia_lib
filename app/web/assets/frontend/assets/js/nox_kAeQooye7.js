import{r as p,j as b,b as i,k as A,C as S,F as x,R as E,_ as I}from"./nox_Ao7tXQoge.js";import{a as L,u as v}from"./nox_ekpgkQhpQ.js";import{c as D}from"./nox_tQkkgoAAo.js";import{D as T}from"./nox_7o7kpkooQ.js";import{R as M}from"./nox_XrXorhXtg.js";import"./nox_oXreoyXoy.js";function N(t){const f=(a,r,s)=>{s.children?s.children.forEach(o=>f(a,[...r,s.id],o)):a.push([...r,s.id])},l=[];return t==null||t.forEach(a=>f(l,[],a)),l}const P=D(t=>{const{sender:f}=L(),{sender:l}=L();return{list:[],pendingInitEffect:!1,initEffect:(a,r,s)=>{t({pendingInitEffect:!0,list:[]}),f({method:"get",path:"legacy/v1/product/category",params:{is_public:!1,marketplace:"shopee",namespace:a,kota:"",pmax:0,pmin:0}},{signal:s,onError:()=>{t(o=>({...o,pendingInitEffect:!1}))},onSuccess:o=>{if(o){if(!o.length){t({pendingInitEffect:!1,list:[]});return}const y=o.map(n=>({productCount:n.count,shopeeCategoryId:n._id,shopeeCategoryName:n.name,tokopediaCategoryIds:[]}));t(n=>({...n,pendingInitEffect:!1,list:y})),l({method:"get",path:"tokopedia/mapper/map",params:{collection:a}},{signal:s,onSuccess(n){var c;if(r){const C=N((c=r.data.categoryAllListLite)==null?void 0:c.categories);n.data.forEach(m=>{C.forEach(d=>{d.indexOf(m.tokopedia_id)>-1&&t(g=>({...g,list:g.list.map(h=>(h.shopeeCategoryId===m.shopee_id&&(h.tokopediaCategoryIds=d),h))}))})})}}})}}})},updateSingleList:(a,r)=>{t(s=>({...s,list:s.list.map(o=>o.shopeeCategoryId==a?{...o,...r}:o)}))},reset:()=>t({list:[],pendingInitEffect:!1})}}),F=E.lazy(()=>I(()=>import("./nox_orAehkoQA.js"),["./nox_orAehkoQA.js","./nox_Ao7tXQoge.js","..\\css\\nox_Xkgoo7t7A.css","./nox_ekpgkQhpQ.js","./nox_oXreoyXoy.js","./nox_kXtpeggoX.js","./nox_yAoXQgok7.js","./nox_hggQyoy7A.js","./nox_QXg7pXkkp.js","./nox_prAehkXhg.js","./nox_ygho7kAgX.js","./nox_7o7kpkooQ.js","./nox_p7og7hphA.js","./nox_AQgQXghgt.js"],import.meta.url)),V=E.lazy(()=>I(()=>import("./nox_oXoeorgoA.js"),["./nox_oXoeorgoA.js","./nox_Ao7tXQoge.js","..\\css\\nox_Xkgoo7t7A.css","./nox_ekpgkQhpQ.js","./nox_oXreoyXoy.js","./nox_kXtpeggoX.js","./nox_yAoXQgok7.js","./nox_hggQyoy7A.js","./nox_QXg7pXkkp.js","./nox_prAehkXhg.js","./nox_7teyQ7Akr.js","./nox_A7tek7epA.js","./nox_7pro7eoph.js","./nox_yeeXokpeX.js","./nox_AQgQXghgt.js","./nox_tpeohhXet.js"],import.meta.url)),w=E.lazy(()=>I(()=>import("./nox_pttehQk7g.js"),["./nox_pttehQk7g.js","./nox_Ao7tXQoge.js","..\\css\\nox_Xkgoo7t7A.css","./nox_ktAgoQpA7.js","./nox_prAehkXhg.js","./nox_A7tek7epA.js","./nox_yAoXQgok7.js","./nox_oXreoyXoy.js","./nox_QXg7pXkkp.js","./nox_khpkttAoh.js","./nox_kXtpeggoX.js","./nox_hggQyoy7A.js","./nox_ygt7XrtAe.js"],import.meta.url));function H(t){const[f,l]=p.useState(!1),[a,r,s,o,y]=P(e=>[e.list,e.initEffect,e.updateSingleList,e.pendingInitEffect,e.reset]),{sender:n,response:c}=v(),{sender:C,response:m}=v(),[d,g]=p.useState(null);p.useEffect(()=>(n({method:"get",path:"tokopedia/category/list"},{onSuccess:e=>{e||l(!0)}}),C({method:"get",path:"legacy/v1/product/namespace_all"},{onSuccess(e){e==null||e.forEach(u=>{u.name!=="default"&&g(u.name)})}}),()=>y()),[]),p.useEffect(()=>{d&&t.activePage=="category_map"&&r(d,c)},[d,c]);const h=p.useMemo(()=>m?m.map(e=>({label:e.name,value:e.name})):[],[m]),R=()=>{var e;if(c){const u=_=>{const k={label:_.name,value:_.id};return _.children&&(k.children=_.children.map(u)),k};return((e=c.data.categoryAllListLite)==null?void 0:e.categories.map(u))||[]}return[]};return b(x,{children:[i(p.Suspense,{fallback:i(A,{}),children:i(F,{onFinish:()=>l(!1),open:f,onCancel:()=>l(!1)})}),i(p.Suspense,{fallback:i(S,{loading:!0}),children:i(V,{list:a,namespace:d,namespaces:h,onChangeNamespace:g,initEffect:r,listCategoryTokopedia:c})}),i(T,{dashed:!0,style:{marginBlock:"5px"}}),!o&&a.length==0?i(M,{status:"404",title:"Data not found!"}):i("div",{style:{display:"grid",gridTemplateColumns:"1fr ",gap:"12px"},children:a.map(e=>i(p.Suspense,{fallback:i(S,{loading:!0}),children:i(w,{categoriesName:e.shopeeCategoryName,productCount:e.productCount,catsValue:e.tokopediaCategoryIds,onChangeCatsValue:u=>{s(e.shopeeCategoryId,{tokopediaCategoryIds:u})},optionsCats:R()},e.shopeeCategoryId)},e.shopeeCategoryId))})]})}export{H as default};
